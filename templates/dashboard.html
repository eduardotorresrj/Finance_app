{% extends 'base.html' %}
{% block title %}Dashboard - Finance App{% endblock %}
{% block content %}
<!-- VERS√ÉO ATUALIZADA: 2025-08-02 16:45:00 -->
<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <!-- Header -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="mb-0">
          <i class="fas fa-home text-primary"></i> Dashboard
        </h2>
        <div class="d-flex">
          <a href="{{ url_for('logout') }}" class="btn btn-outline-danger">
            <i class="fas fa-sign-out-alt"></i> Sair
          </a>
        </div>
      </div>

      <!-- Saldo Atual -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card border-0 shadow-sm">
            <div class="card-body text-center py-4">
              <h5 class="card-title text-muted mb-3">
                <i class="fas fa-wallet"></i> Saldo Atual
              </h5>
              <h1 class="mb-0 {% if saldo >= 0 %}text-success{% else %}text-danger{% endif %} fw-bold">
                R$ {{ "%.2f"|format(saldo) }}
              </h1>
            </div>
          </div>
        </div>
      </div>

      <!-- Gr√°fico e Contas a Vencer -->
      <div class="row mb-4">
        <!-- Gr√°fico -->
        <div class="col-lg-8 mb-4">
          <div class="card border-0 shadow-sm h-100">
            <div class="card-header bg-primary text-white">
              <h5 class="card-title mb-0">
                <i class="fas fa-chart-line"></i> Resumo Financeiro
              </h5>
            </div>
            <div class="card-body">
              {% if bar_chart %}
                <div id="bar_chart" style="height: 350px; width: 100%;"></div>
                <script>
                  var bar = {{ bar_chart|safe }};
                  Plotly.newPlot('bar_chart', bar.data, bar.layout, {
                    responsive: true,
                    displayModeBar: false,
                    modeBarButtonsToRemove: ['pan2d', 'lasso2d', 'select2d']
                  });
                </script>
              {% else %}
                <div class="text-center text-muted py-5">
                  <i class="fas fa-chart-bar fa-4x mb-3 text-muted"></i>
                  <h5>Nenhum dado dispon√≠vel</h5>
                  <p class="mb-0">Adicione transa√ß√µes para ver os gr√°ficos.</p>
                </div>
              {% endif %}
            </div>
          </div>
        </div>

        <!-- Contas a Vencer -->
        <div class="col-lg-4 mb-4">
          <div class="card border-0 shadow-sm h-100">
            <div class="card-header bg-warning text-dark">
              <h5 class="card-title mb-0">
                <i class="fas fa-clock"></i> Contas a Vencer
              </h5>
            </div>
            <div class="card-body">
              {% if contas_vencer %}
                <div class="list-group list-group-flush">
                  {% for c in contas_vencer %}
                    <div class="list-group-item border-0 px-0">
                      <div class="d-flex justify-content-between align-items-center">
                        <div>
                          <h6 class="mb-1 fw-bold">{{ c.category }}</h6>
                          <small class="text-muted">
                            <i class="fas fa-calendar"></i> {{ c.due_date.strftime('%d/%m/%Y') }}
                          </small>
                        </div>
                        <span class="badge bg-warning text-dark fs-6 px-3 py-2">
                          R$ {{ "%.2f"|format(c.amount) }}
                        </span>
                      </div>
                    </div>
                  {% endfor %}
                </div>
              {% else %}
                <div class="text-center text-muted py-4">
                  <i class="fas fa-check-circle fa-3x mb-3 text-success"></i>
                  <h6>Nenhuma conta a vencer</h6>
                  <p class="mb-0 small">Voc√™ est√° em dia! üéâ</p>
                </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>

      <!-- Bot√µes de A√ß√£o -->
      <div class="row">
        <div class="col-md-3 mb-3">
          <a href="{{ url_for('add_transaction') }}" class="btn btn-primary w-100 py-3 shadow-sm">
            <i class="fas fa-plus-circle fa-lg mb-2"></i><br>
            <span class="fw-bold">Adicionar Transa√ß√£o</span>
          </a>
        </div>
        <div class="col-md-3 mb-3">
          <a href="{{ url_for('add_bill') }}" class="btn btn-warning w-100 py-3 shadow-sm">
            <i class="fas fa-calendar-plus fa-lg mb-2"></i><br>
            <span class="fw-bold">Adicionar Conta</span>
          </a>
        </div>
        <div class="col-md-3 mb-3">
          <a href="{{ url_for('reports') }}" class="btn btn-info w-100 py-3 shadow-sm">
            <i class="fas fa-chart-pie fa-lg mb-2"></i><br>
            <span class="fw-bold">Ver Relat√≥rios</span>
          </a>
        </div>
        <div class="col-md-3 mb-3">
          <a href="{{ url_for('ai_analysis_page') }}?v=20250802164500" class="btn btn-success w-100 py-3 shadow-sm">
            <i class="fas fa-robot fa-lg mb-2"></i><br>
            <span class="fw-bold">IA Financeira</span>
          </a>
        </div>
      </div>


    </div>
  </div>
</div>


{% endblock %} 